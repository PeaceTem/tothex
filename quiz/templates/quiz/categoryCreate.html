{% extends 'quiz/base.html' %}
{% load static %}
{% load social_share %}

{% block quizTitle %}
Categories
{% endblock quizTitle %}

{% block content %}

{% block quizCss %}
<link rel="stylesheet" href="{% static 'quiz/css/categoryCreate.css' %}">
{% endblock quizCss %}
<section>
<div class="head">Step 2 of 3</div>

<h3>Add Categories</h3>

<div class="top-info">You can add up to 5 categories <br>Categories: {{quizCategories.count}}</div>
<input type="hidden" name="quiz" id="quiz" value="{{quiz.id}}">

{% include 'messages.html' %}
<div class="category-create" >
    <form action="" id="category-form" method="get">
        <input class="search" type="text" name="newCategory" id="newCategory" placeholder="add title">
        <input type="submit" value="create">
    </form>
</div>


<form action="" id="added-category-form" method="get">
    click on a category in this bucket to remove it<br>
    <fieldset>
        <legend>Bucket</legend>
        <div id="categoryBucket">

            {% for category in quizCategories %}
            <input type='text' id="{{category.title}}"  class="addedCategories" onclick="removeCategory(this.id)" name="addedCategories" value={{category.title}} readonly>
        {% endfor %}
        </div>
    </fieldset>
    


    <input type="submit" value="add all the categories in the bucket to the quiz">
</form>


<!-- Add infinite scroll to the category with ajax -->
<div class="infinite-container">
    Click on any of the categories below to add it to the bucket above<br>
{% for category in page_obj %}
<span class="infinite-item">
    <input type="button" onclick="addClassCategory(this.value)" value="{{category.title}}">
</span>
{% endfor %}
</div>

<div class="row d-none">
    <div class="col-12">
        {% if page_obj.has_next %}
        <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}">next</a>
        {% endif %}
        </span>
    </div>
</div>

<div>
    
<a href="{% url 'quiz:new-question' quiz.id %}">
    <button>Add more Questions</button>
</a>

</div>
</section>
<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
<script src="{% static 'js/infinite.min.js' %}"></script>
<script>
    var infinite = new Waypoint.Infinite({
        element: $('.infinite-container')[0],

        offset: 'bottom-in-view',

        onBeforePageLoad: function () {
            $('.loading').show();
        },
        onAfterPageLoad: function () {
            $('.loading').hide();
        }
        
    
    });
</script>

<script type="text/javascript">

function addClassCategory(obj_name){
        var bucket = document.getElementById('categoryBucket');

        bucket.innerHTML += `
                                <input type="text" class = "addedCategories" name="addedCategories" value=${obj_name} readonly>
                            `;

    }

    function removeCategory(index){
        var elem = document.getElementById(index);
        elem.parentNode.removeChild(elem);
    }



</script>
   
</body>
</html>



{% endblock content %}
